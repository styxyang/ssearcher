#include "magic.h"

#define M_3GPP_FTYP        0x0000001466747970
#define M_MP4_FTYP         0x0000001866747970
#define M_3GPP2_FTYP       0x0000002066747970
#define M_ICO              0x00000100
#define M_TAR_ZIP_LZW      0x1F9D
#define M_TAR_ZIP_LZH      0x1FA0
#define M_PDF              0x25504446
#define M_PSD              0x38425053
#define M_BMP              0x424D
#define M_ISO9660          0x4344303031
#define M_GIF0             0x474946383761
#define M_GIF1             0x474946383961
#define M_MP3_V2           0x494433
#define M_TIF              0x49492A00
#define M_TIFF             0x4D4D002A
#define M_EXE              0x4D5A
#define M_OGG              0x4F676753
#define M_ZIP              0x504B0304
#define M_ZIP_EMPTY        0x504B0506
#define M_ZIP_SPANNED      0x504B0708
#define M_RAR15            0x526172211A0700
#define M_RAR50            0x526172211A070100
#define M_FLAC             0x664C6143
#define M_ELF              0x7F454C46
#define M_PNG              0x89504E470D0A1A0A
#define M_MACH_O_FAT_CLASS 0xCAFEBABE
#define M_MACH32_O_BE      0xCEFAEDFE
#define M_MACH64_O_BE      0xCFFAEDFE
#define M_MS_OFFICE        0xD0CF11E0
#define M_UTF8_BOM         0xEFBBBF
#define M_MACH32_O_LE      0xFEEDFACE
#define M_MACH64_O_LE      0xFEEDFACF
#define M_MP3_V01          0xFFFB
#define M_UTF16_BOM_LE     0xFFFE
#define M_UTF32_BOM_LE     0xFFFE0000

static uint32_t magic_index[][MENTRY_LEN + 1] = {
    {0x000, 0x000, 0x000, 0x014, 0x066, 0x074, 0x079, 0x070, 8},
    {0x000, 0x000, 0x000, 0x018, 0x066, 0x074, 0x079, 0x070, 8},
    {0x000, 0x000, 0x000, 0x020, 0x066, 0x074, 0x079, 0x070, 8},
    {0x000, 0x000, 0x001, 0x000, 0x100, 0x100, 0x100, 0x100, 4},
    {0x01F, 0x09D, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 2},
    {0x01F, 0x0A0, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 2},
    {0x025, 0x050, 0x044, 0x046, 0x100, 0x100, 0x100, 0x100, 4},
    {0x038, 0x042, 0x050, 0x053, 0x100, 0x100, 0x100, 0x100, 4},
    {0x042, 0x04D, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 2},
    {0x043, 0x044, 0x030, 0x030, 0x031, 0x100, 0x100, 0x100, 5},
    {0x047, 0x049, 0x046, 0x038, 0x037, 0x061, 0x100, 0x100, 6},
    {0x047, 0x049, 0x046, 0x038, 0x039, 0x061, 0x100, 0x100, 6},
    {0x049, 0x044, 0x033, 0x100, 0x100, 0x100, 0x100, 0x100, 3},
    {0x049, 0x049, 0x02A, 0x000, 0x100, 0x100, 0x100, 0x100, 4},
    {0x04D, 0x04D, 0x000, 0x02A, 0x100, 0x100, 0x100, 0x100, 4},
    {0x04D, 0x05A, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 2},
    {0x04F, 0x067, 0x067, 0x053, 0x100, 0x100, 0x100, 0x100, 4},
    {0x050, 0x04B, 0x003, 0x004, 0x100, 0x100, 0x100, 0x100, 4},
    {0x050, 0x04B, 0x005, 0x006, 0x100, 0x100, 0x100, 0x100, 4},
    {0x050, 0x04B, 0x007, 0x008, 0x100, 0x100, 0x100, 0x100, 4},
    {0x052, 0x061, 0x072, 0x021, 0x01A, 0x007, 0x000, 0x100, 7},
    {0x052, 0x061, 0x072, 0x021, 0x01A, 0x007, 0x001, 0x000, 8},
    {0x066, 0x04C, 0x061, 0x043, 0x100, 0x100, 0x100, 0x100, 4},
    {0x07F, 0x045, 0x04C, 0x046, 0x100, 0x100, 0x100, 0x100, 4},
    {0x089, 0x050, 0x04E, 0x047, 0x00D, 0x00A, 0x01A, 0x00A, 8},
    {0x0CA, 0x0FE, 0x0BA, 0x0BE, 0x100, 0x100, 0x100, 0x100, 4},
    {0x0CE, 0x0FA, 0x0ED, 0x0FE, 0x100, 0x100, 0x100, 0x100, 4},
    {0x0CF, 0x0FA, 0x0ED, 0x0FE, 0x100, 0x100, 0x100, 0x100, 4},
    {0x0D0, 0x0CF, 0x011, 0x0E0, 0x100, 0x100, 0x100, 0x100, 4},
    {0x0EF, 0x0BB, 0x0BF, 0x100, 0x100, 0x100, 0x100, 0x100, 3},
    {0x0FE, 0x0ED, 0x0FA, 0x0CE, 0x100, 0x100, 0x100, 0x100, 4},
    {0x0FE, 0x0ED, 0x0FA, 0x0CF, 0x100, 0x100, 0x100, 0x100, 4},
    {0x0FF, 0x0FB, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 2},
    {0x0FF, 0x0FE, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 2},
    {0x0FF, 0x0FE, 0x000, 0x000, 0x100, 0x100, 0x100, 0x100, 4}
};

int query_magic()
{
    return 0;
}
